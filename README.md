# 🎮 MacroRecorder - 宏录制工具

一个功能强大的 Windows 桌面宏录制与播放工具，支持录制鼠标和键盘操作，并可自定义播放速度和循环播放。

<img width="806" height="643" alt="image" src="https://github.com/user-attachments/assets/c6246fff-0f0d-4232-ab93-60c949362700" />
<img width="286" height="333" alt="image" src="https://github.com/user-attachments/assets/6aef1987-6219-4d51-bd90-e691aadc50ae" />



## ✨ 主要特性

### 🎯 核心功能
- **全局录制**：捕获鼠标移动、点击、滚轮和键盘按键
- **精确回放**：高精度时间控制，准确重现操作
- **速度调节**：支持 0.5x、1x、2x 播放速度
- **循环播放**：可设置无限循环执行宏操作
- **系统托盘**：最小化到托盘，后台运行不干扰工作

### ⌨️ 快捷键系统
- **可自定义快捷键**：所有操作均支持自定义快捷键
- **组合键支持**：支持 Ctrl+、Alt+、Shift+ 组合键
- **实时冲突检测**：输入时自动检测并提示快捷键冲突
- **直观设置界面**：点击输入框，直接按键即可设置

### 💾 文件管理
- **保存/加载**：将录制的宏保存为 JSON 文件
- **跨会话使用**：保存的宏可在任何时候加载使用
- **可视化编辑**：在表格中查看所有录制的操作事件

## 🚀 快速开始

### 系统要求
- Windows 10/11
- .NET 8.0 或更高版本
- Visual Studio 2026（用于开发）

### 安装运行

#### 方式一：直接运行（推荐）
1. 下载最新的 Release 版本
2. 解压到任意目录
3. 双击 `MacroRecorder.exe` 启动

#### 方式二：从源码编译
```bash
# 克隆仓库
git clone https://github.com/p1aychess/MacroRecorder.git
cd MacroRecorder

# 使用 Visual Studio 打开 MacroRecorder.sln
# 或使用命令行编译
dotnet build
dotnet run
```

## 📖 使用指南

### 基本操作流程

#### 1. 录制宏
1. 点击 **"开始录制"** 按钮或按 `F9`
2. 窗口自动最小化到托盘
3. 执行你要录制的鼠标和键盘操作
4. 按 `F10` 停止录制
5. 窗口恢复，显示录制的事件列表

#### 2. 播放宏
1. 在事件列表中查看录制的操作
2. 选择播放速度（0.5x / 1x / 2x）
3. 勾选"循环播放"（可选）
4. 点击 **"播放"** 按钮或按 `F7`
5. 按 `F8` 随时停止播放

#### 3. 保存与加载
- **保存**：点击 "保存" 或 "另存为" 按钮
- **加载**：点击 "加载" 按钮选择已保存的 JSON 文件

### 默认快捷键

| 功能 | 默认快捷键 | 说明 |
|------|-----------|------|
| 开始录制 | `F9` | 开始录制鼠标和键盘操作 |
| 停止录制 | `F10` | 停止录制并返回主窗口 |
| 播放宏 | `F7` | 开始播放已录制的宏 |
| 停止播放 | `F8` | 中止当前播放 |

> 💡 提示：所有快捷键均可自定义，点击主窗口的 "快捷键设置" 按钮进行修改

### 快捷键自定义

1. 点击主窗口底部的 **"快捷键设置"** 按钮
2. 点击要修改的输入框
3. 直接按下想要设置的键（支持组合键）
4. 系统自动检测冲突并提示
5. 点击 "保存" 应用设置

**支持的组合键格式：**
- 单键：`F1`, `A`, `Space`
- Ctrl 组合：`Ctrl+F1`, `Ctrl+A`
- Alt 组合：`Alt+F1`, `Alt+A`
- Shift 组合：`Shift+F1`, `Shift+Space`
- 多重组合：`Ctrl+Alt+F1`, `Ctrl+Shift+A`

## 🎨 功能截图

### 主界面
- 清晰的操作按钮布局
- 事件列表实时显示
- 快捷键提示一目了然

### 快捷键设置
- 直观的按键捕获
- 实时冲突检测
- 视觉化反馈提示

### 系统托盘
- 右键菜单快速操作
- 录制状态图标闪烁
- 气泡通知提醒

## 🔧 高级功能

### 播放速度控制
- **0.5x**：放慢 50%，适合精确操作
- **1x**：原速播放，完全还原录制
- **2x**：加快 100%，快速执行重复任务

### 循环播放
- 勾选"循环播放"选项
- 宏将持续执行直到手动停止
- 适合需要重复多次的任务

### 事件编辑
- 在表格中查看每个操作的详细信息
- 显示时间间隔、操作类型、按键代码、坐标等
- 清空列表重新录制

## ⚙️ 技术架构

### 核心技术
- **WPF**：现代化的用户界面
- **Windows Hook API**：全局鼠标和键盘监听
- **SendInput API**：高精度输入模拟
- **JSON 序列化**：宏文件存储

### 项目结构
```
MacroRecorder/
├── MainWindow.xaml          # 主窗口界面
├── MainWindow.xaml.cs       # 主窗口逻辑
├── HotkeySettingWindow.xaml # 快捷键设置界面
├── HotkeySettingWindow.xaml.cs # 快捷键设置逻辑
├── hotkeys.json             # 快捷键配置文件
└── *.macro.json             # 用户保存的宏文件
```

### 关键特性实现
- **全局钩子**：使用低级键盘和鼠标钩子捕获系统级事件
- **精确时间**：记录操作间隔，确保回放时序准确
- **事件隔离**：设置窗口与主窗口按键事件完全隔离
- **状态管理**：托盘图标闪烁、窗口状态同步等

## 🐛 常见问题

### Q: 录制后播放不准确？
**A:** 确保播放时保持与录制时相同的屏幕分辨率和窗口布局。

### Q: 快捷键不响应？
**A:** 检查是否有其他程序占用了相同的快捷键。尝试在"快捷键设置"中更改为其他按键。

### Q: 能否录制特定窗口的操作？
**A:** 当前版本录制的是全局操作。建议录制时保持目标窗口在前台。

### Q: 为什么设置窗口中按快捷键会触发录制？
**A:** 这个问题已在 v2.0 版本中修复。请更新到最新版本。

### Q: 支持录制游戏操作吗？
**A:** 支持大部分游戏，但某些使用 DirectInput 或反作弊系统的游戏可能无法正常录制/播放。

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

### 贡献流程
1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

### 开发规范
- 遵循现有代码风格
- 添加必要的注释
- 更新相关文档
- 确保编译无警告

## 📋 更新日志

### v2.0.0 (2025-12-15)
- ✨ 新增直接按键输入功能
- ✨ 支持组合键设置（Ctrl+/Alt+/Shift+）
- ✨ 实时快捷键冲突检测
- ✨ 视觉反馈优化（焦点高亮、冲突提示）
- 🐛 修复设置窗口中按键误触发主窗口功能
- 💄 优化用户体验和界面交互

### v1.0.0 (2025-12-05)
- 🎉 初始版本发布
- 基础录制和播放功能
- 系统托盘支持
- 文件保存/加载

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## 👨‍💻 作者

**p1aychess**
- GitHub: [@p1aychess](https://github.com/p1aychess)
- Email: 26974127@qq.com

## 🙏 鸣谢

- 感谢所有贡献者的支持
- 感谢开源社区提供的灵感和参考

## 📮 联系方式

如有问题或建议，欢迎通过以下方式联系：
- 提交 [Issue](https://github.com/p1aychess/MacroRecorder/issues)
- 发送邮件到 26974127@qq.com

---

⭐ 如果这个项目对你有帮助，请给个 Star 支持一下！
